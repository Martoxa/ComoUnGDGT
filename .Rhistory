EarthChordDistances(matrix(c(-99.133209,19.432608),ncol=2),matrix(c(5.104480,52.092876),ncol=2))
a<-c(1,2)
a
class(a)
is.vector(a)
b<-3
class(b)
is.vector(b)
length(a)
length(b)
test<-function(a,b,c){a+b+c}
test(1,2,3)
test(1,2)
source("bayspar_tex.R")
bayspar_tex()
source("bayspar_tex.R")
bayspar_tex()
source("bayspar_tex.R")
bayspar_tex()
source("bayspar_tex.R")
bayspar_tex()
bayspar_tex(5)
bayspar_tex(c(1,2))
bayspar_tex(c(1,2,5))
source("bayspar_tex.R")
bayspar_tex(c(1,2,5))
bayspar_tex(c(1,2))
bayspar_tex(5)
source("bayspar_tex.R")
bayspar_tex(c(1,2,5))
bayspar_tex(c(1,2))
bayspar_tex(5)
source("bayspar_tex.R")
bayspar_tex(c(1,2,5))
bayspar_tex(c(1,2))
bayspar_tex(5)
library(R.matlab)
setwd("C:/Users/Marti150/OneDrive - Universiteit Utrecht/Documents/GitHub/BAYSPAR/ModelOutput")
readMat("Output_SpatAg_SST/params_standard.mat")
SST_param_std<-readMat("Output_SpatAg_SST/params_standard.mat")
SST_param_std
summary(SST_param_std)
SST_param_std$Locs.Comp
SST_param_std$alpha.samples.comp
SST_param_std$alpha.samples.comp[1]
SST_param_std$alpha.samples.comp[2]
class(SST_param_std$alpha.samples.comp)
dim(SST_param_std$alpha.samples.comp)
SST_param_ana<-readMat("Output_SpatAg_SST/params_analog.mat")
SubT_param_std<-readMat("Output_SpatAg_subT/params_standard.mat")
SubT_param_ana<-readMat("Output_SpatAg_subT/params_analog.mat")
obsSST<-readMat("obsSST.mat")
obssubT<-readMat("obssubT.mat")
summary(obsSST)
obsSST$locs.st.obs
setwd("C:/Users/Marti150/OneDrive - Universiteit Utrecht/Documents/GitHub/ComoUnGDGT")
saveRDS(SST_param_std,file="SST_param_std.rds")
saveRDS(SST_param_ana,file="SST_param_ana.rds")
saveRDS(SubT_param_ana,file="SubT_param_ana.rds")
saveRDS(SubT_param_std,file="SubT_param_std.rds")
saveRDS(obsSST,file="obsSST.rds")
saveRDS(obssubT,file="obssubT.rds")
?seq
seq(1,20000,length.out=1000)
Params<-readRDS(file="SST_param_std.rds")
length(Params$tau2.samples)
dim(Params$alpha.samples.comp)
round(seq(1,length(Params$tau2.samples),length.out=1000))
Params$alpha.samples.comp[,ind_s]
ind_s<-round(seq(1,length(Params$tau2.samples),length.out=1000))
Params$alpha.samples.comp[,ind_s]
Params$beta.samples.comp[,ind_s]
alpha_samples_comp<-Params$alpha.samples.comp[,ind_s]
beta_samples_comp<-Params$beta.samples.comp[,ind_s]
Params$tau2.samples[ind_s]
tau2_samples<-Params$tau2.samples[ind_s]
Nd<-10
matrix(NaN,nrow=Nd,ncol=3)
matrix(NaN,nrow = 2,ncol=1)
obsSST$locs.st.obs
class(obsSST$locs.st.obs)
lon<-runif(10,-180,180)
lon
lat<-runif(10,-90,90)
Output_SiteLoc<-as.matrix(cbind(lon,lat))
Output_SiteLoc
EarthChordDistances(Output_SiteLoc,obsSST$locs.st.obs)
dim(Output_SiteLoc)
dim(EarthChordDistances(Output_SiteLoc,obsSST$locs.st.obs))
dim(obsSST$locs.st.obs)
dist_prior<-EarthChordDistances(Output_SiteLoc,obsSST$locs.st.obs)
dist_prior[1,1]
dist_prior[1,2]
?sort
sort(dist_prior)
sort(dist_prior,index.return=TRUE)
sort(dist_prior,index.return=TRUE)[1]
sort(dist_prior,index.return=TRUE)[2]
?find
?match
vals_dist_prior<-sort(dist_prior,index.return=TRUE)[1]
inds_dist_prior<-sort(dist_prior,index.return=TRUE)[2]
vals_dist_prior
as.vector(sort(dist_prior,index.return=TRUE)[1])
class(vals_dist_prior)
summary(vals_dist_prior)
max_dist<-500
vals_dist_prior<max_dist
as.vector(vals_dist_prior)<max_dist
as.vector(vals_dist_prior$x)<max_dist
sorted_dist_prior<-sort(dist_prior,index.return=TRUE)
summary(sorted_dist_prior)
sorted_dist_prior[[x]]<max_dist
sorted_dist_prior$x<max_dist
lon
lat
dists_prior<-EarthChordDistances(Output_SiteLoc,obsSST$locs.st.obs)
sorted_dist_prior<-sort(dists_prior,index.return=TRUE)
sorted_dist_prior$x[sorted_dist_prior$x<max_dist]
tail(sorted_dist_prior$x[sorted_dist_prior$x<max_dist],n=1)
dim(sorted_dist_prior$x)
length(sorted_dist_prior$x)
?sort
?apply
apply(dists_prior,2,sort,index.return=TRUE)
sorted_dist_prior<-apply(dists_prior,2,sort,index.return=TRUE)
summary(sorted_dist_prior)
apply(dists_prior,2,sort)
dim(apply(dists_prior,2,sort))
test<-apply(dists_prior,2,sort)
test[,1]
?sort
test<-apply(dists_prior,2,sort,index.return=TRUE)
test$1
test[1]
test[2]
dim(test)
summary(test)
sorted_dist_prior<-apply(dists_prior,2,sort)
dim(sorted_dist_prior)
dim(dist_prior)
sorted_dist_prior[,1]
dist_prior[,1]
?match
dists_prior %in% sorted_dist_prior
match(sorted_dist_prior,dists_prior)
apply(sorted_dist_prior,2,match,table=dists_prior)
dim(sorted_dist_prior<max_dist)
sorted_dist_prior<max_dist
sorted_dist_prior<max_dist[,1]
test<-sorted_dist_prior<max_dist
test[,1]
sorted_dist_prior[test]
sorted_dist_prior
sorted_dist_prior[,1]
sorted_dist_prior<max_dist
test<-sorted_dist_prior<max_dist
test[,1]
dim(test)
test[,37686]
test[,37686/2]
sorted_dist_prior[test]
colSums(sorted_dist_prior<max_dist)
lon=c(-123.393333, -30.57452)
lat=(-48.876667, 46.07258)
lat=c(-48.876667, 46.07258)
Output_SiteLoc<-as.matrix(cbind(lon,lat))
Output_SiteLoc
dists_prior<-EarthChordDistances(Output_SiteLoc,obsSST$locs.st.obs)
dim(dists_prior)
rm(dist_prior)
sorted_dist_prior<-apply(dists_prior,2,sort)
sorted_dist_prior[,1]
sorted_dist_prior<max_dist
test<-sorted_dist_prior<max_dist
test[,1:20]
test[,18007]
match(sorted_dist_prior[,1],dists_prior[,1])
match(sorted_dist_prior[,10],dists_prior[,10])
match(sorted_dist_prior[,15],dists_prior[,15])
match(sorted_dist_prior[,100],dists_prior[,100])
match(sorted_dist_prior[,18000],dists_prior[,18000])
apply(sorted_dist_prior[,1:3],2,match,table=dists_prior[,1:3])
apply(sorted_dist_prior[,1:10],2,match,table=dists_prior[,1:10])
apply(sorted_dist_prior[,18000:18010],2,match,table=dists_prior[,1:10])
apply(sorted_dist_prior[,18000:18010],2,match,table=dists_prior[,18000:18010])
sorted_dist_prior[,18000:18010]<max_dist
tail(sorted_dist_prior[,18000:18010]<max_dist)
c(sorted_dist_prior[,18000:18010])
?with
c(sorted_dist_prior[,18000:18010])<max_dist
tail(c(sorted_dist_prior[,18000:18010])[c(sorted_dist_prior[,18000:18010])<max_dist])
tail(c(sorted_dist_prior[,18000:18010])[c(sorted_dist_prior[,18000:18010])<max_dist],n=1)
tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1)
match(tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),dists_prior)
length(c(sorted_dist_prior))
dim(dists_prior)
tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1) %in% dists_prior
class(dists_prior)
A
A<-matrix(NA,ncol=10,nrow=15)
A
A[3,10]<-5
A
A[14,4]<-5
A
A[14,4]<-7
match(4,A)
match(5,A)
match(5,A)/dim(A)[1]
match(5,as.table(A))
which(tail(dists_prior = c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1))
which(dists_prior = tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1))
tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1)
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1))
which(A=5)
which(A==5)
A
?which()
which(A==5,arr.ind = TRUE)
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)[2]
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)[,2]
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)[[col]]
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)[col]
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)$col
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)[[2]]
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)[,2]
18008*2
Obs<-readRDS(file = "obssubT.rds")
summary(inds_dist_prior)
sorted_dist_prior
sorted_dist_prior[,1]
match(tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),dists_prior)
apply(sorted_dist_prior[,18000:18010],2,match,table=dists_prior[,18000:18010])
apply(sorted_dist_prior[,18000:18010],1,match,table=dists_prior[,18000:18010])
match(sorted_dist_prior[,18000:18010],dists_prior[,18000:18010])
?match()
sorted_dist_prior
sorted_dist_prior[,1]
match(sorted_dist_prior[,1],dists_prior[,1])
match(sorted_dist_prior[,1:3],dists_prior[,1:3])
which(sorted_dist_prior[,1:3]==dists_prior[,1:3])
which(sorted_dist_prior[,1:3]==dists_prior[,1:3],arr.ind = TRUE)
which(sorted_dist_prior[,1:3]==dists_prior[,1:3],arr.ind = TRUE)[1]
which(sorted_dist_prior[,1:3]==dists_prior[,1:3],arr.ind = TRUE)[,1]
length(Obs$st.obs.ave.vec)
Obs$st.obs.ave.vec[c(1,1,1)]
inds_dist_prior<-which(sorted_dist_prior==dists_prior,arr.ind = TRUE)[,1]
inds_dist_prior
?seq
num_below_dist<-which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)[,2]
num_below_dist
seq(from=1,to=num_below_dist,by=1)
max(seq(from=1,to=num_below_dist,by=1))
num_below_dist
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)
dists_prior<-EarthChordDistances(Output_SiteLoc,obsSST$locs.st.obs)
dim(dists_prior)
Output_SiteLoc
sorted_dist_prior<-apply(dists_prior,2,sort)
View(sorted_dist_prior)
inds_dist_prior<-which(sorted_dist_prior==dists_prior,arr.ind = TRUE)[,1]
inds_dist_prior
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = FALSE)
Obs$st.obs.ave.vec[36015]
Obs$st.obs.ave.vec[36016]
Obs$st.obs.ave.vec[1]
Obs2<-readRDS(file = "obsSST.rds")
Obs2$st.obs.ave.vec[1]
Obs<-readRDS(file = "obsSST.rds")
Params<-readRDS(file="SST_param_std.rds")
grid_half_space<-10
min_num<-1
max_dist<-500
ind_s<-round(seq(1,length(Params$tau2.samples),length.out=1000))
alpha_samples_comp<-Params$alpha.samples.comp[,ind_s]
beta_samples_comp<-Params$beta.samples.comp[,ind_s]
tau2_samples<-Params$tau2.samples[ind_s]
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1))
dists_prior<-EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs)
sorted_dist_prior<-apply(dists_prior,2,sort)
inds_dist_prior<-which(sorted_dist_prior==dists_prior,arr.ind = TRUE)[,1]
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1))
Obs$st.obs.ave.vec[1]
num_below_dist<-which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)[,2]
Obs$st.obs.ave.vec[num_below_dist]
which(sorted_dist_prior==dists_prior,arr.ind = TRUE)
which(dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)
dists_prior[,18008]
sorted_dist_prior[,18008]
sorted_dist_prior[,18007:18009]
which(sorted_dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)
sorted_dist_prior<-apply(dists_prior,2,sort)
which(sorted_dists_prior == tail(c(sorted_dist_prior)[c(sorted_dist_prior)<max_dist],n=1),arr.ind = TRUE)
dists_prior<-EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs)
sorted_dists_prior<-apply(dists_prior,2,sort)
inds_dists_prior<-which(sorted_dist_prior==dists_prior,arr.ind = TRUE)[,1]
num_below_dist<-which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_disst_prior)<max_dist],n=1),arr.ind = TRUE)[,2]
num_below_dist<-which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = TRUE)[,2]
num_below_dist
num_below_dist<-which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = TRUE)
num_below_dist
num_below_dist<-which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = FALSE)
num_below_dist
num_below_dist<-which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = FALSE)
num_below_dist
mean(Obs$st.obs.ave.vec[inds_dist_prior[seq(from=1,to=num_below_dist,by=1)]])
mean(Obs$st.obs.ave.vec[inds_dist_prior[seq(from=1,to=min_num,by=1)]])
if(num_below_dist>min_num){prior_mean<-mean(Obs$st.obs.ave.vec[inds_dist_prior[seq(from=1,to=num_below_dist,by=1)]])
} else {prior_mean<-mean(Obs$st.obs.ave.vec[inds_dist_prior[seq(from=1,to=min_num,by=1)]])}
Output_PriorMean<-prior_mean
Output_PriorMean
lon<--17.6635
lon
lat<-9.1660
Output_SiteLoc<-as.matrix(cbind(lon,lat))
Output_SiteLoc
dists_prior<-EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs)
sorted_dists_prior<-apply(dists_prior,2,sort)
inds_dists_prior<-which(sorted_dist_prior==dists_prior,arr.ind = TRUE)[,1]
sorted_dist_prior
dim(sorted_dist_prior)
dim(dists_prior)
inds_dists_prior<-which(sorted_dists_prior==dists_prior,arr.ind = TRUE)[,1]
num_below_dist<-which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = FALSE)
num_below_dist
Params<-readRDS(file="SST_param_std.rds")
Obs<-readRDS(file = "obsSST.rds")
grid_half_space<-10
min_num<-1
max_dist<-500
ind_s<-round(seq(1,length(Params$tau2.samples),length.out=1000))
alpha_samples_comp<-Params$alpha.samples.comp[,ind_s]
beta_samples_comp<-Params$beta.samples.comp[,ind_s]
tau2_samples<-Params$tau2.samples[ind_s]
lon<--17.6635
lat<-9.1660
source("RrthChordDistances.R")
Output_SiteLoc<-as.matrix(cbind(lon,lat))
dists_prior<-EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs)
sorted_dists_prior<-apply(dists_prior,2,sort)
inds_dists_prior<-which(sorted_dists_prior==dists_prior,arr.ind = TRUE)[,1]
num_below_dist<-which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = FALSE)
num_below_dist
c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist]
which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = TRUE)
sorted_dists_prior[num_below_dist]
if(num_below_dist>min_num){prior_mean<-mean(Obs$st.obs.ave.vec[inds_dist_prior[seq(from=1,to=num_below_dist,by=1)]])
} else {prior_mean<-mean(Obs$st.obs.ave.vec[inds_dist_prior[seq(from=1,to=min_num,by=1)]])}
if(num_below_dist>min_num){prior_mean<-mean(Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=num_below_dist,by=1)]])
} else {prior_mean<-mean(Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=min_num,by=1)]])}
prior_mean
mean(Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=num_below_dist,by=1)]])
which(sorted_dists_prior==dists_prior,arr.ind = TRUE)
apply(dists_prior[,1:10],2,sort)
dim(dists_prior)
dists_prior[,1:10]
apply(dists_prior[,1:10],2,sort)
dists_prior[,1]
sorted_dists_prior<-apply(dists_prior,2,sort)
sorted_dists_prior[,1:10]
dim(sorted_dists_prior)
size(sorted_dists_prior)
length(sorted_dists_prior)
sorted_dists_prior
c(sorted_dists_prior)<max_dist
sorted_dists_prior[,1:60]
sorted_dists_prior[1:60]
dists_prior[1:10]
sort(dists_prior[1:10])
apply(dists_prior[1:10],2,sort)
apply(dists_prior[,1:10],2,sort)
apply(dists_prior[1,1:10],2,sort)
apply(dists_prior[1,1:10],1,sort)
dim(dists_prior)
dim(dists_prior)[2]
dim(dists_prior)[1]
sort(dists_prior)
apply(dists_prior,2,sort)
apply(dists_prior,2,sort)
sorted_dists_prior<-apply(dists_prior,2,sort)
which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = FALSE)
sorted_dists_prior<-apply(dists_prior,2,sort)
sorted_dists_prior
dim(Obs$locs.st.obs)
EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs[1:10,])
dists_prior<-EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs[1:10,])
dists_prior
apply(dists_prior,2,sort)
sorted_dists_prior<-apply(dists_prior,2,sort)
which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = FALSE)
EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs[37586:37686,])
EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs[1:100,])
EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs[1:1000,])
dim(Obs$locs.st.obs)
EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs[36686:37686,])
EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs[36786:37686,])
dists_prior<-EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs)
sorted_dists_prior<-apply(dists_prior,2,sort)
which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = FALSE)
sorted_dists_prior[19543]
sort(dists_prior)
apply(dists_prior,2,sort)
dists_prior(1:10)
dists_prior[1:10]
sorted_dists_prior[1:10]
dim(lon)
length(lon)
sorted_dists_prior<-if(length(lon)==1){sort(dists_prior)} else if(length(lon)>1){apply(dists_prior,2,sort)}
inds_dists_prior<-which(sorted_dists_prior==dists_prior,arr.ind = TRUE)[,1]
num_below_dist<-which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = FALSE)
num_below_dist
if(num_below_dist>min_num){prior_mean<-mean(Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=num_below_dist,by=1)]])
} else {prior_mean<-mean(Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=min_num,by=1)]])}
prior_mean
dists_prior<-EarthChordDistances(Output_SiteLoc,Obs$locs.st.obs)
sorted_dists_prior<-if(length(lon)==1){sort(dists_prior)} else if(length(lon)>1){apply(dists_prior,2,sort)}
inds_dists_prior<-which(sorted_dists_prior==dists_prior,arr.ind = TRUE)[,1]
num_below_dist<-which(sorted_dists_prior == tail(c(sorted_dists_prior)[c(sorted_dists_prior)<max_dist],n=1),arr.ind = FALSE)
if(num_below_dist>min_num){prior_mean<-mean(Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=num_below_dist,by=1)]])
} else {prior_mean<-mean(Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=min_num,by=1)]])}
prior_mean
num_below_dist
mean(Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=num_below_dist,by=1)]])
Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=num_below_dist,by=1)]]
seq(from=1,to=num_below_dist,by=1)
inds_dists_prior[seq(from=1,to=num_below_dist,by=1)]
inds_dists_prior
which(sorted_dists_prior==dists_prior,arr.ind = TRUE)
which(sorted_dists_prior==dists_prior)
dists_prior
dists_prior[1:10]
which(sorted_dists_prior==dists_prior,arr.ind = FALSE)
?which
sorted_dists_prior==dists_prior
test<-sorted_dists_prior==dists_prior
test[1:10]
match(sorted_dists_prior,dists_prior)
inds_dists_prior<-if(length(lon)==1){match(sorted_dists_prior,dists_prior)} else if(length(lon)>1){which(sorted_dists_prior==dists_prior,arr.ind = TRUE)[,1]
match(sorted_dists_prior,dists_prior)
]
inds_dists_prior<-if(length(lon)==1){match(sorted_dists_prior,dists_prior)} else if(length(lon)>1){which(sorted_dists_prior==dists_prior,arr.ind = TRUE)[,1]}
inds_dists_prior
if(num_below_dist>min_num){prior_mean<-mean(Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=num_below_dist,by=1)]])
} else {prior_mean<-mean(Obs$st.obs.ave.vec[inds_dists_prior[seq(from=1,to=min_num,by=1)]])}
prior_mean
Params$Locs.Comp
Params$Locs.Comp-lon
Params$Locs.Comp[,1]-lon
which(abs(Params$Locs.Comp[,1]-lon)<= grid_half_space)
which(abs(Params$Locs.Comp[,1]-lon)<= grid_half_space & abs(Params$Locs.Comp[,2]-lat)<= grid_half_space)
inder_g<- which(abs(Params$Locs.Comp[,1]-lon)<=grid_half_space)
alpha_samples_comp<-Params$alpha_samples_comp[inder_g,]
beta_samples_comp<-Params$beta_samples_comp[inder_g,]
dim(alpha_samples_comp)
Params$alpha.samples.comp
Params$alpha.samples.comp[inder_g,]
dim(Params$alpha.samples.comp)
inder_g<- which(abs(Params$Locs.Comp[,1]-lon)<=grid_half_space & abs(Params$Locs.Comp[,2]-lat)<= grid_half_space)
inder_g
alpha_samples_comp<-Params$alpha_samples_comp[inder_g,]
dim(Params$alpha_samples_comp[inder_g,])
dim(Params$alpha_samples_comp)
Params<-readRDS(file="SST_param_std.rds")
dim(Params$alpha_samples_comp)
length(Params$alpha_samples_comp)
Params$alpha.samples.comp[1:10]
Params$alpha.samples.comp[1:10,]
Params$alpha.samples.comp[1:10,2]
class(Params$alpha_samples_comp)
as.matrix(Params$alpha_samples_comp)
Params<-readRDS(file="SST_param_std.rds")
summary(Params)
as.data.frame(Params$alpha.samples.comp)
dim(as.data.frame(Params$alpha.samples.comp))
test<-as.data.frame(Params$alpha.samples.comp)
test[1:5,1:5]
as.data.frame(Params$alpha.samples.comp)[141]
as.data.frame(Params$alpha.samples.comp)[141,]
as.data.frame(Params$alpha.samples.comp)[141,1:5]
alpha_samples_comp<-as.data.frame(Params$alpha_samples_comp)[inder_g,]
beta_samples_comp<-as.data.frame(Params$beta_samples_comp)[inder_g,]
alpha_samples_comp
alpha_samples_comp[1]
alpha_samples_comp[,1]
as.data.frame(Params$alpha_samples_comp)[inder_g,]
inder_g
as.data.frame(Params$alpha_samples_comp[inder_g,])
test<-as.data.frame(Params$alpha_samples_comp)
Params<-readRDS(file="SST_param_std.rds")
test<-as.data.frame(Params$alpha_samples_comp)
as.data.frame(Params$alpha_samples_comp)
as.data.frame(Params$alpha.samples.comp)[141,]
as.data.frame(Params$alpha.samples.comp)[inder_g,]
alpha_samples_comp<-as.data.frame(Params$alpha.samples.comp)[inder_g,]
beta_samples_comp<-as.data.frame(Params$beta.samples.comp)[inder_g,]
Params$Locs.Comp[inder_g,]
dim(Params$Locs.Comp)
lon2<-c(-32,175)
Params$Locs.Comp[,1]-lon2
length(Params$Locs.Comp[,1])
Nd<-1
matrix(1,Nd,1)
prior_mean
matrix(1,Nd,1)*prior_mean
varargin=1000
Nsamps<-varargin
kronecker(matrix(1,1,Nsamps),matrix(1,Nd,1)*prior_mean)
pmu<-kronecker(matrix(1,1,Nsamps),matrix(1,Nd,1)*prior_mean)
dim(pmu)
